.include "m16def.inc" 

.ORG 0x000
	JMP RESET

RESET:
	LDI R16, 0b10000111							;ENABLE ADC CONVERTER, SET PRESCALING TO CLK/128 -> 125 kHZ
	OUT ADCSRA, R16
	
	LDI R16, 0b00011111							;ENABLE PULL UP RESISTORS OF PA0-PA1
	OUT PORTA, R16
	
	LDI R16, 0b11111111							;DEFINE PORTB OUTPUT
	OUT DDRB, R16
	LDI R16, 0xFF								;TURN OFF LEDS TO PORTB
	OUT PORTB, R16


MAIN:

READ_PA0:
	LDI R16, 0b11000000							;INTERNAL VREF 2.56 V. ADLAR = 0(RIGHT ADJUSTED)->READ ADCL, PA0
	OUT ADMUX, R16
	
	LDI R16, 0b11000111							;ENABLE ADC CONVERTER, START CONVERSION, SET PRESCALING TO CLK/128 -> 125 kHZ
	OUT ADCSRA, R16
PA0_CONVERSION:
	SBIC ADCSRA, 6								;IF ADCSRA:6(ADSC) IS CLEARED THEN THE CONVERSION HAS BEEN COMPLETED
	JMP PA0_CONVERSION

STORE_PA0:
	IN R17, ADCL								;ADLAR == 0 THEN IT IS RIGHT ADJUSTED

	CPI R17, 0x0F
	BRGE TURN_ON_LED0
TURN_OFF_LED0:
	SBI PORTB, 0
	JMP READ_PA1
TURN_ON_LED0:
	CBI PORTB, 0


READ_PA1:
	LDI R16, 0b11000001							;INTERNAL VREF 2.56 V. ADLAR = 0(RIGHT ADJUSTED)->READ ADCL, PA1
	OUT ADMUX, R16
	
	LDI R16, 0b11000111							;ENABLE ADC CONVERTER, START CONVERSION, SET PRESCALING TO CLK/128 -> 125 kHZ
	OUT ADCSRA, R16
PA1_CONVERSION:
	SBIC ADCSRA, 6								;IF ADCSRA:6(ADSC) IS CLEARED THEN THE CONVERSION HAS BEEN COMPLETED
	JMP PA1_CONVERSION

STORE_PA1:
	IN R17, ADCL								;ADLAR == 0 THEN IT IS RIGHT ADJUSTED

	CPI R17, 0x0F
	BRGE TURN_ON_LED1
TURN_OFF_LED1:
	SBI PORTB, 1
	JMP READ_PA2
TURN_ON_LED1:
	CBI PORTB, 1


READ_PA2:
	LDI R16, 0b11000010							;INTERNAL VREF 2.56 V. ADLAR = 0(RIGHT ADJUSTED)->READ ADCL, PA2
	OUT ADMUX, R16
	
	LDI R16, 0b11000111							;ENABLE ADC CONVERTER, START CONVERSION, SET PRESCALING TO CLK/128 -> 125 kHZ
	OUT ADCSRA, R16
PA2_CONVERSION:
	SBIC ADCSRA, 6								;IF ADCSRA:6(ADSC) IS CLEARED THEN THE CONVERSION HAS BEEN COMPLETED
	JMP PA2_CONVERSION

STORE_PA2:
	IN R17, ADCL								;ADLAR == 0 THEN IT IS RIGHT ADJUSTED

	CPI R17, 0x0F
	BRGE TURN_ON_LED2
TURN_OFF_LED2:
	SBI PORTB, 2
	JMP READ_PA3
TURN_ON_LED2:
	CBI PORTB, 2


READ_PA3:
	LDI R16, 0b11000011							;INTERNAL VREF 2.56 V. ADLAR = 0(RIGHT ADJUSTED)->READ ADCL, PA3
	OUT ADMUX, R16
	
	LDI R16, 0b11000111							;ENABLE ADC CONVERTER, START CONVERSION, SET PRESCALING TO CLK/128 -> 125 kHZ
	OUT ADCSRA, R16
PA3_CONVERSION:
	SBIC ADCSRA, 6								;IF ADCSRA:6(ADSC) IS CLEARED THEN THE CONVERSION HAS BEEN COMPLETED
	JMP PA3_CONVERSION

STORE_PA3:
	IN R17, ADCL								;ADLAR == 0 THEN IT IS RIGHT ADJUSTED

	CPI R17, 0x0F
	BRGE TURN_ON_LED3
TURN_OFF_LED3:
	SBI PORTB, 3
	JMP READ_PA4
TURN_ON_LED3:
	CBI PORTB, 3


READ_PA4:
	LDI R16, 0b11000100							;INTERNAL VREF 2.56 V. ADLAR = 0(RIGHT ADJUSTED)->READ ADCL, PA4
	OUT ADMUX, R16
	
	LDI R16, 0b11000111							;ENABLE ADC CONVERTER, START CONVERSION, SET PRESCALING TO CLK/128 -> 125 kHZ
	OUT ADCSRA, R16
PA4_CONVERSION:
	SBIC ADCSRA, 6								;IF ADCSRA:6(ADSC) IS CLEARED THEN THE CONVERSION HAS BEEN COMPLETED
	JMP PA4_CONVERSION

STORE_PA4:
	IN R17, ADCL								;ADLAR == 0 THEN IT IS RIGHT ADJUSTED

	CPI R17, 0x0F
	BRGE TURN_ON_LED4
TURN_OFF_LED4:
	SBI PORTB, 4
	JMP FINISH
TURN_ON_LED4:
	CBI PORTB, 4


FINISH:
	JMP MAIN
