.include "m16def.inc" 

.ORG 0x000
	JMP RESET

RESET:
	LDI R16, 0b10000101							;ENABLE ADC CONVERTER, SET PRESCALING TO CLK/128 -> 125 kHZ
	OUT ADCSRA, R16
	
	LDI R16, 0b11111111							;ENABLE PULL UP RESISTORS OF PA0-PA1
	OUT PORTA, R16
	
	LDI R16, 0b11111111							;DEFINE PORTB OUTPUT
	OUT DDRB, R16
	LDI R16, 0b11111111							;TURN OFF LEDS TO PORTB
	OUT PORTB, R16


MAIN:

READ_PA0:
	LDI R16, 0b11100000						;INTERNAL VREF 2.56 V. ADLAR = 0(RIGHT ADJUSTED)->READ ADCL, PA0
	OUT ADMUX, R16
	
	LDI R16, 0b11000111							;ENABLE ADC CONVERTER, START CONVERSION, SET PRESCALING TO CLK/128 -> 125 kHZ
	OUT ADCSRA, R16
PA0_CONVERSION:
	SBIC ADCSRA, 6								;IF ADCSRA:6(ADSC) IS CLEARED THEN THE CONVERSION HAS BEEN COMPLETED
	JMP PA0_CONVERSION

STORE_PA0:
	IN R17, ADCH
	;IN R17, ADCL								;ADLAR == 0 THEN IT IS RIGHT ADJUSTED

	CPI R17, 0x0F
	BRSH TURN_ON_LED0
TURN_OFF_LED0:
	SBI PORTB, 0
	JMP FINISH
TURN_ON_LED0:
	CBI PORTB, 0


FINISH:
	JMP MAIN
